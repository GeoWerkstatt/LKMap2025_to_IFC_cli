
qodana-python:
  image:
    name: jetbrains/qodana-python
    entrypoint: ['']
  script:
      - qodana --save-report --results-dir=$CI_PROJECT_DIR/qodana
         --report-dir=$CI_PROJECT_DIR/qodana/report
  variables:
      QODANA_TOKEN: $qodana_token
      QODANA_REMOTE_URL: git@$CI_SERVER_HOST:$CI_PROJECT_PATH.git
      QODANA_BRANCH: $CI_COMMIT_BRANCH
      QODANA_REVISION: $CI_COMMIT_SHA
      QODANA_JOB_URL: $CI_JOB_URL
  artifacts:
      paths:
         - qodana

unit-tests:
  image: python:latest
  variables:
    PIP_CACHE_DIR: "$CI_PROJECT_DIR/.cache/pip"
  cache:
    paths:
      - .cache/pip
      - venv/
  before_script:
    - python3 -V  # Print out python version for debugging
    - pip3 install virtualenv
    - virtualenv venv
    - source venv/bin/activate
    - pip3 install pyogrio
    - pip3 install ifcopenshell
    - pip3 install scipy
    - pip3 install python-dotenv
  script:
    - python3 -m unittest
